{% extends "base.html" %}

{% block title %}Student Details{% endblock title %}

{% block body %}
<div class="container mt-5">
    <h2 class="text-center">Student Details</h2>
    <div class="card">
        <div class="card-header">
            <h4>{{ student.first_name }} {{ student.last_name }}</h4>
        </div>
        <div class="card-body">
            <p><strong>Registration Number:</strong> {{ student.registration_number }}</p>
            <p><strong>Roll Number:</strong> {{ student.roll_number }}</p>
            <p><strong>Attendance:</strong> {{ student.attendance }}%</p>
            <p><strong>CIE Marks:</strong> {{ student.cie_marks }}/20</p>
            <p><strong>Batch:</strong> {{ student.batch.name }}</p>
            <p><strong>Division:</strong> {{ student.division.name }}</p>
            <p><strong>Subjects:</strong></p>
        </div>

      <table>
    <tr>
        <th>Subject</th>
        <th>NOC Status</th>
        <th>Action</th>
    </tr>
    {% for info in student_subjects_info %}
    <tr>
        <td>{{ info.subject.subject_name }}</td>
        <td>{% if info.noc_signed %} <span style="color: green;">Signed</span> {% else %} <span style="color: red;">Not Signed</span> {% endif %}</td>
        <td>
            {% if info.is_teacher_assigned %}
                <form method="POST" action="{% url 'sign_noc_for_subject' student.registration_number info.subject.subject_id %}">
                    {% csrf_token %}
                    <button type="submit">Sign NOC</button>
                </form>
            {% else %}
                Only the assigned teacher can sign.
            {% endif %}
        </td>
    </tr>
    {% endfor %}
</table>

    <div class="text-center mt-4">
        <a href="{% url 'show_batch_data' %}" class="btn btn-info">View Batch</a>
    </div>

{% endblock body %}
